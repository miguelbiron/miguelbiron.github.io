<!DOCTYPE html>

<html lang="en-us">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Miguel Biron-Lattes</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="/css/main.min.364181395f068614d02615981b918adfd0601b252899e92b7dd17982855dd4e8.css"/>
    
    
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/xcode.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

    
    
    

    
    <link type="text/css" rel="stylesheet" href="/css/custom.css">
 
    
    
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="/">Miguel Biron-Lattes</a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="/docs/miguel_biron_cv.pdf">CV</a>
  
    <a class="color-link nav-link" href="/post/">Old blog</a>
  
  
</div>
<footer class="footer">
	<div class="social-icons">
        
    <a class="social-icon" href="mailto:miguel.biron@stat.ubc.ca" target="_blank" rel="noopener" title="Email">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M25.2794292,5.59128519 L14,16.8707144 L2.72057081,5.59128519 C3.06733103,5.30237414 3.51336915,5.12857603 4,5.12857603 L24,5.12857603 C24.4866308,5.12857603 24.932669,5.30237414 25.2794292,5.59128519 Z M25.9956978,6.99633695 C25.998551,7.04004843 26,7.08414302 26,7.12857603 L26,20.871424 C26,21.0798433 25.9681197,21.2808166 25.9089697,21.4697335 L18.7156355,14.2763993 L25.9956978,6.99633695 Z M24.9498374,22.6319215 C24.6672737,22.7846939 24.3437653,22.871424 24,22.871424 L4,22.871424 C3.5268522,22.871424 3.09207889,22.7071233 2.74962118,22.432463 L10.0950247,15.0870594 L13.9848068,18.9768415 L14.1878486,18.7737996 L14.2030419,18.7889929 L17.6549753,15.3370594 L24.9498374,22.6319215 Z M2.00810114,21.0526627 C2.00273908,20.9929669 2,20.9325153 2,20.871424 L2,7.12857603 C2,7.08414302 2.00144896,7.04004843 2.00430222,6.99633695 L9.03436454,14.0263993 L2.00810114,21.0526627 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://linkedin.com/in/miguelbiron" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/miguelbiron" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    <a class="social-icon" href="https://stackoverflow.com/users/5443023" target="_blank" rel="noopener" title="Stack Overflow">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M20.8863636,23.7090909 L20.8863636,17.3818182 L22.9863636,17.3818182 L22.9863636,25.8090909 L4.03181818,25.8090909 L4.03181818,17.3818182 L6.13181818,17.3818182 L6.13181818,23.7090909 L20.8863636,23.7090909 Z M8.45,16.7818182 L8.88636364,14.7090909 L19.1954545,16.8636364 L18.7590909,18.9363636 L8.45,16.7818182 Z M9.81363636,11.8727273 L10.6863636,9.93636364 L20.2318182,14.4090909 L19.3590909,16.3181818 L9.81363636,11.8727273 Z M12.4590909,7.18181818 L13.7954545,5.57272727 L21.8954545,12.3090909 L20.5590909,13.9181818 L12.4590909,7.18181818 Z M17.6954545,2.19090909 L23.9681818,10.6454545 L22.2772727,11.9 L16.0045455,3.44545455 L17.6954545,2.19090909 Z M8.23181818,21.5818182 L8.23181818,19.4818182 L18.7590909,19.4818182 L18.7590909,21.5818182 L8.23181818,21.5818182 Z"></path>
        </svg>
    </a>
    
    
    

    
</div>




	<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
	<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>

	<script src="/js/main.min.a7205ef73b078c8daed6fe1b0826e8ba229ffabbb69d299d9446cf41f2c7d8aa.js" integrity="sha256-pyBe9zsHjI2u1v4bCCbouiKf+ru2nSmdlEbPQfLH2Ko="></script>
</footer>
</nav>

        <div id="content" class="content-container">
        
<h1 class="post-title">Visualizing Fourier series in 2D and 3D</h1>
    
    <time>March 9, 2018</time>
    
    <div>
        <p>
        


<p>In this post, I will give a brief description of real valued Fourier series in higher dimensions, with some neat plots. I started reading about Fourier series because in the 1D case they are useful for extracting periodic patterns from time series data. However, I ended up fascinated by the pretty pictures one could get by plotting random 2D series, or by the periodic videos made by “walking” along a 3D space “painted”&quot; with a Fourier series.</p>
<div id="fourier-series-in-higher-dimensions" class="section level2">
<h2>Fourier series in higher dimensions</h2>
<p>In this section I will be loosely following chapter 8 of the lecture notes prepared by Prof. Brad Osgood for his course <em>The fourier Transform and its Applications</em>, which can be found <a href="https://see.stanford.edu/materials/lsoftaee261/book-fall-07.pdf">here</a>.</p>
<p>A function <code>$f:\mathbb{R}^d \to \mathbb{C}$</code> is said to be <strong>periodic with period 1</strong> if <code>$\forall \boldsymbol{x} \in \mathbb{R}^d, \mathbb{Z}^d$</code>: <code>$$ f(\boldsymbol{x} + \boldsymbol{n}) = f(\boldsymbol{x}) $$</code></p>
<p>The set <code>$\mathbb{Z}^d$</code> is known as the <strong><code>$d$</code>-dimensional integer lattice</strong>, whose elements are <code>$d$</code>-tuples of integers: <code>$$ \mathbb{Z}^d = \{\boldsymbol{n} = (n_1, ..., n_d): n_1, ..., n_d \in \mathbb{Z}\} $$</code></p>
<p>Now, suppose that <code>$f$</code> is a periodic function of period 1 which is also <strong>square-integrable</strong>; i.e., <code>$f \in L^2([-1, 1]^d)$</code>. This means that: <code>$$ \int_{[-1, 1]^d} |f(\boldsymbol{x})|^2 d\boldsymbol{x} &lt; \infty $$</code></p>
<p>In this case, we know there exists a Fourier series: <code>$$ s(\boldsymbol{x}) = \sum_{\boldsymbol{n}} c_{\boldsymbol{n}}e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} $$</code></p>
<p>where <code>$c_{\boldsymbol{n}} \in \mathbb{C}^d$</code>, such that: <code>$$ \int_{[-1, 1]^d} |f(\boldsymbol{x}) - s(\boldsymbol{x})|^2 d\boldsymbol{x} = 0 $$</code></p>
<p>This is a direct consequence of the fact that the set <code>$\{e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}}: \boldsymbol{n} \in \mathbb{Z}^d \}$</code> is a basis for the space <code>$L^2([-1, 1]^d)$</code>.</p>
</div>
<div id="fourier-series-of-real-valued-functions" class="section level2">
<h2>Fourier series of real-valued functions</h2>
<p>In the special case where <code>$f$</code> is real-valued, when can greatly reduce the amount of coefficients needed to represent <code>$f$</code>. Indeed, if the function is real-valued, then <code>$\forall \boldsymbol{x} \in \mathbb{R}^d$</code>: <code>$$ \begin{aligned} 0 &amp;= \Im(f(\boldsymbol{x})) \\ &amp;= \Im(s(\boldsymbol{x})) \\ &amp;= \Im\left( \sum_{\boldsymbol{n}} c_{\boldsymbol{n}}e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} \right) \\ &amp;= \sum_{\boldsymbol{n}} \Im( c_{\boldsymbol{n}}e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}}) \end{aligned} $$</code></p>
<p>where <code>$\Im(z)$</code> is the imaginary part of <code>$z$</code>. Now, using that: <code>$$ \begin{aligned} c_{\boldsymbol{n}} &amp;= a_{\boldsymbol{n}} + ib_{\boldsymbol{n}} \\ e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} &amp;= \cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) + i\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) \end{aligned} $$</code></p>
<p>we obtain: <code>$$ c_{\boldsymbol{n}}e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} = [a_{\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) - b_{\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x})] + i[b_{\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) + a_{\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x})] $$</code></p>
<p>Hence, <code>$$ \Im(c_{\boldsymbol{n}}e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}}) = b_{\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) + a_{\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) $$</code></p>
<p>Now, the only way to force this element of the series to be zero for every <code>$\boldsymbol{x}$</code> and <code>$\boldsymbol{n}$</code> would be to set <code>$a_{\boldsymbol{n}} = b_{\boldsymbol{n}} = 0$</code>, which would defeat the purpose. Instead, we are going to take advantage of the parity of <code>$\cos$</code> and <code>$\sin$</code>. Indeed, for every <code>$\boldsymbol{n} \in \mathbb{Z}^d$</code>, the term associated with its additive inverse will be: <code>$$ \begin{aligned} \Im(c_{-\boldsymbol{n}}e^{2\pi i (-\boldsymbol{n}) \cdot \boldsymbol{x}}) &amp;=  b_{-\boldsymbol{n}}\cos(2\pi (-\boldsymbol{n}) \cdot \boldsymbol{x}) + a_{-\boldsymbol{n}}\sin(2\pi (-\boldsymbol{n}) \cdot \boldsymbol{x}) \\ &amp;=  b_{-\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) - a_{-\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) \end{aligned} $$</code></p>
<p>Therefore, by pairing every <code>$\boldsymbol{n}$</code>-th term with its corresponding <code>$(-\boldsymbol{n})$</code>-th term: <code>$$ \Im(c_{\boldsymbol{n}}e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}}) + \Im(c_{-\boldsymbol{n}}e^{2\pi i (-\boldsymbol{n}) \cdot \boldsymbol{x}})  = (b_{\boldsymbol{n}} + b_{-\boldsymbol{n}})\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) + (-a_{\boldsymbol{n}} + a_{-\boldsymbol{n}})\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) $$</code></p>
<p>we see that we can cancel the imaginary part of the series by forcing every sum of such pairs of elements to be 0 with the condition that: <code>$$ \begin{aligned} b_{\boldsymbol{n}} + b_{-\boldsymbol{n}} &amp;= 0 \\ a_{\boldsymbol{n}} - a_{-\boldsymbol{n}} &amp;= 0 \end{aligned} \qquad \forall \boldsymbol{n} \in \mathbb{Z}^d $$</code></p>
<p>This can be restated in terms of the original <code>$c_{\boldsymbol{n}}$</code>: <code>$$ c_{-\boldsymbol{n}} = a_{-\boldsymbol{n}} + ib_{-\boldsymbol{n}} = a_{\boldsymbol{n}} - ib_{\boldsymbol{n}} = c_{\boldsymbol{n}}^* $$</code></p>
<p>which means that <strong>the coefficients of a real-valued fourier series come in conjugate pairs</strong>.</p>
<p>Finally, suppose that we have a partition of <code>$\mathbb{Z}^d = \{\boldsymbol{0}_d\} \cup \mathcal{H}_- \cup \mathcal{H}_+$</code>, such that:</p>
<ol style="list-style-type: decimal">
<li><code>$\mathcal{H}_- \cap \mathcal{H}_+ = \mathcal{H}_- \cap \{\boldsymbol{0}_d\} = \mathcal{H}_+ \cap \{\boldsymbol{0}_d\} = \emptyset$</code></li>
<li><code>$\forall \boldsymbol{n} \neq \boldsymbol{0}_d: (\boldsymbol{n} \in \mathcal{H}_- \land -\boldsymbol{n} \in \mathcal{H}_+) \lor (\boldsymbol{n} \in \mathcal{H}_+ \land -\boldsymbol{n} \in \mathcal{H}_-)$</code></li>
</ol>
<p>We could then rewrite the formula for the Fourier series as: <code>$$ \begin{aligned} s(\boldsymbol{x}) &amp;= \sum_{\boldsymbol{n}} c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} \\ &amp;= c_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-}  c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} + \sum_{\boldsymbol{n} \in \mathcal{H}_+}  c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} \\ &amp;= c_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-} \left( c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} + c_{\boldsymbol{n}}^* e^{-2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} \right) \\ &amp;= c_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-} \left( c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} + (c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}})^* \right) \\ &amp;= c_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-} 2\Re \left(  c_{\boldsymbol{n}} e^{2\pi i \boldsymbol{n} \cdot \boldsymbol{x}} \right) \\ &amp;= c_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-} 2 \left( a_{\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) - b_{\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) \right) \\ &amp;= a_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-} \left( a_{\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) + b_{\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) \right) \end{aligned} $$</code></p>
<p>where in the last line we simply renamed the coefficients of the series (<code>$c_{\boldsymbol{0}_d}$</code> is real because it is its own complex conjugate). Note that when <code>$d = 1$</code>, we recover the standard formula for the real-valued 1D Fourier series, because in that case <code>$\mathcal{H}_- = \mathbb{Z}^+$</code>.</p>
<p>For the sake of completeness, here is a simple procedure for creating the partition:</p>
<ol style="list-style-type: decimal">
<li><code>$\mathcal{H}_- \gets \emptyset$</code></li>
<li>For <code>$k=1...d$</code>
<ol style="list-style-type: lower-roman">
<li><code>$\mathcal{H}_- \gets \mathcal{H}_- \cup \{\boldsymbol{n} \in \mathbb{Z}^d: n_{1:k-1}=0 \land n_k &lt; 0 \}$</code></li>
</ol></li>
<li><code>$\mathcal{H}_+ \gets (\mathbb{Z}^d \setminus \{\boldsymbol{0}_d\}) \setminus \mathcal{H}_-$</code></li>
</ol>
</div>
<div id="visualizing-the-series" class="section level2">
<h2>Visualizing the series</h2>
<p>Of course, in order to play with Fourier series in a regular computer, we must truncate them. For this, we define the set: <code>$$ \mathcal{H}_-^N = \{\boldsymbol{n} \in \mathcal{H}_-: n_k \leq N, \forall k=1...d\} $$</code></p>
<p>where <code>$N$</code> is the highest harmonic we will allow in any dimension. The expression for the truncated Fourier series is given by: <code>$$ s^N(\boldsymbol{x}) = a_{\boldsymbol{0}_d} + \sum_{\boldsymbol{n} \in \mathcal{H}_-^N} \left( a_{\boldsymbol{n}}\cos(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) + b_{\boldsymbol{n}}\sin(2\pi \boldsymbol{n} \cdot \boldsymbol{x}) \right) $$</code></p>
<p>Now we are ready to play in R! Let’s start by loading some helpful libraries:</p>
<pre class="r"><code>library(ggplot2)
library(dplyr)
## 
## Attaching package: &#39;dplyr&#39;
## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
library(tidyr)
library(gganimate)

set.seed(1313)</code></pre>
<p>Below is the code of a procedure that builds a truncated Fourier series for a given dimension <code>$d$</code> and maximum harmonic <code>$N$</code>, without the intercept term <code>$a_{\boldsymbol{0}_d}$</code>. Note that it allows for functions with periods other than 1 by simply rescaling the argument. Also, the set <code>$\mathcal{H}_-^N$</code>, represented by the matrix <code>n_mat</code>, is built simply by taking all the combinations in the cross product <code>$\{-N, -N+1, ..., N-1, N\}^d$</code>, sorting them (done implicitly by <code>expand.grid</code>), and then taking the first half without the intercept (exactly <code>$k = [(2N+1)^d-1]/2$</code> terms).</p>
<pre class="r"><code># builds a real valued fourier series without an intercept
# mandatory inputs: maximum harmonic (N) and dimension (d)
# other inputs are sampled at random if not present
get_fourier_series = function(N, d, P=NULL, a=NULL, b=NULL){
  
  k = as.integer(((2*N + 1)^d - 1) / 2) # number of summation terms
  
  # set null parameters
  if(is.null(P)){
    P = runif(d, pi, 2*pi) # periods of each dimension
  }
  if(is.null(a)){
    a = rnorm(k) # cosine coefficients
  }
  if(is.null(b)){
    b = rnorm(k) # sine coefficients
  }
  n_mat = as.matrix(expand.grid(lapply(1:d, function(i){(-N):N}))) # subset of integer lattice
  n_mat = n_mat[1:k, ] # drop redundant terms
  
  # build function
  f_s = function(X){
    # input:
    #     - X: matrix of size m \times d
    
    m = nrow(X)
    X = 2 * pi * (X * rep(1/P, each = m)) # scale argument
    XM_t = tcrossprod(X, n_mat) # matrix of size m \times k
    return(drop(cos(XM_t) %*% a + sin(XM_t) %*% b))
  }
  
  return(f_s)
}</code></pre>
<div id="plot-2d-functions-with-varying-n" class="section level3">
<h3>Plot 2d functions with varying <code>$N$</code></h3>
<p>To visualize 2D series, we are going to paint 8 squares with truncated Fourier series using increasingly higher harmonics. To build the required data, we create a grid and repeat that grid 8 times. Then, we sample 8 functions at random, and we assign them to each grid. Notice how we make use of list-columns in order to have a data frame with a column of functions. Finally, we evaluate the functions at every point of the grid.</p>
<pre class="r"><code># image parameters
N_vec = 1:8 # maximum harmonics
res = 480 # resolution = res x res
l = 10 # limits for (x, y) dimensions

# create grid, repeat for every N
df_grid_2d =
  expand.grid(
    x = seq(-l, l, length.out = res),
    y = seq(-l, l, length.out = res),
    N = N_vec,
    KEEP.OUT.ATTRS = FALSE
  ) %&gt;%
  as_data_frame() %&gt;%
  # join with data.frame with a fourier series for each N
  inner_join(tibble::tibble(N = N_vec) %&gt;%
               mutate(f = lapply(N, function(n) {
                 get_fourier_series(N = n, d = 2)
               })),
             by = &quot;N&quot;) %&gt;%
  # evaluate functions
  group_by(N) %&gt;% 
  mutate(z = f[[1]](cbind(x,y))) %&gt;% 
  select(-f) %&gt;%  # drop functions
  # standardize results of every function for comparability in visualization
  mutate(z = (z - mean(z)) / sd(z)) %&gt;%
  ungroup()</code></pre>
<p>And now we plot. I like this image because the designs look like they could be used as gift wrapping paper. Of course, the periodic patterns are evident, and they become increasingly complex as we allow higher harmonics to be included.</p>
<pre class="r"><code># plot
df_grid_2d %&gt;%
  ggplot(aes(x = x, y = y)) +
  geom_raster(aes(fill = z), show.legend = FALSE) +
  scale_fill_distiller(type = &quot;div&quot;) +
  coord_fixed() +
  facet_wrap(~ N, labeller = as_labeller(function(x) {
    sprintf(&quot;N = %s&quot;, x)
  }), nrow = 2) +
  theme_void()</code></pre>
<p><img src="/post/2018-03-05-visualizing-fourier-series-2d-3d_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="walking-through-a-3d-space-painted-with-a-fourier-series" class="section level3">
<h3>Walking through a 3D space painted with a Fourier series</h3>
<p>Finally, we are going to take advantage of the periodic nature of Fourier series to build a nice GIF that will smoothly loop without glitches. We do this by evaluating the function in a 3D grid, and then slicing the space along a path defined by one of the 3 coordinates. Specifically, for this animation we will sample a truncated Fourier series with known periods, and then we will navigate along the <code>$z$</code> axis for a full period.</p>
<pre class="r"><code># function parameters 
N = 1 # number of harmonics
P_z = 2*pi # period for the z dimension
l = P_z/2 # limits for (x, y) dimensions

# animation parameters
steps = 100 # how many frames
res = 480 # size of image = res x res

f_s_3d = get_fourier_series(N = N, d = 3, P = rep(P_z, 3))

# build data
df_grid_3d =
  expand.grid(
    x = seq(-l, l, length.out = res),
    y = seq(-l, l, length.out = res),
    t = 1:steps,
    KEEP.OUT.ATTRS = FALSE
  ) %&gt;%
  as_data_frame() %&gt;%
  # add z variable for each step
  inner_join(
    data.frame(t = 1:steps,
               z = seq(0, P_z, length.out = steps))
    , by = &quot;t&quot;) %&gt;%
  # multidplyr::partition(t) %&gt;% 
  mutate(s = f_s_3d(cbind(x, y, z))) %&gt;% 
  select(-z) # %&gt;% 
  # collect()</code></pre>
<p>The above process is slow and tedious, but it can be trivially parallelized by using the package <code>multidplyr</code> with the addition of a couple of extra lines of codes. However, I couldn’t get <code>blogdown</code> to work with a cluster, but you can try it at home by un-commenting the last lines in the chunk.</p>
<p>Below is the resulting animation. Isn’t its smoothness relaxing?</p>
<pre class="r"><code># plot
p = df_grid_3d %&gt;%
  ggplot(aes(x = x, y = y, frame = t)) +
  geom_raster(aes(fill = s), show.legend = FALSE) +
  scale_fill_gradient(low = &quot;black&quot;, high = &quot;white&quot;) +
  coord_fixed() +
  theme_void()

# animate
gganimate(plot        = p,
          title_frame = FALSE)</code></pre>
<p><img src="/post/2018-03-05-visualizing-fourier-series-2d-3d_files/figure-html/unnamed-chunk-5.gif" width="240" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="final-remarks" class="section level2">
<h2>Final remarks</h2>
<p>In this post I have given a brief introduction to real-valued Fourier series in higher dimensions. I gave a practical demonstration of the concept by visualizing functions for the cases where <code>$d\in \{2, 3\}$</code>. I think that this seemingly “useless” concept of making pretty pictures of mathematical objects can be very enlightening, because it gives you a more intuitive grasp of the underlying concepts.</p>
</div>

        </p>
    </div>
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "the-mblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    <div class="page-footer">
        <hr class="footer-divider">
        
        
            <a class="tag" href="/tags/fourier-series">#Fourier series</a>
        
            <a class="tag" href="/tags/visualization">#visualization</a>
        
            <a class="tag" href="/tags/r">#R</a>
        
      
    </div>


        

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>



<script src="/js/math-code.js"></script>


<script>
      renderMathInElement(
          document.body,
          {
              delimiters: [
                  {left: "$$", right: "$$", display: true},
                  {left: "\\[", right: "\\]", display: true},
                  {left: "$", right: "$", display: false},
                  {left: "\\(", right: "\\)", display: false}
              ]
          }
      );
</script>

        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        
    <a class="social-icon" href="mailto:miguel.biron@stat.ubc.ca" target="_blank" rel="noopener" title="Email">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M25.2794292,5.59128519 L14,16.8707144 L2.72057081,5.59128519 C3.06733103,5.30237414 3.51336915,5.12857603 4,5.12857603 L24,5.12857603 C24.4866308,5.12857603 24.932669,5.30237414 25.2794292,5.59128519 Z M25.9956978,6.99633695 C25.998551,7.04004843 26,7.08414302 26,7.12857603 L26,20.871424 C26,21.0798433 25.9681197,21.2808166 25.9089697,21.4697335 L18.7156355,14.2763993 L25.9956978,6.99633695 Z M24.9498374,22.6319215 C24.6672737,22.7846939 24.3437653,22.871424 24,22.871424 L4,22.871424 C3.5268522,22.871424 3.09207889,22.7071233 2.74962118,22.432463 L10.0950247,15.0870594 L13.9848068,18.9768415 L14.1878486,18.7737996 L14.2030419,18.7889929 L17.6549753,15.3370594 L24.9498374,22.6319215 Z M2.00810114,21.0526627 C2.00273908,20.9929669 2,20.9325153 2,20.871424 L2,7.12857603 C2,7.08414302 2.00144896,7.04004843 2.00430222,6.99633695 L9.03436454,14.0263993 L2.00810114,21.0526627 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://linkedin.com/in/miguelbiron" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/miguelbiron" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    <a class="social-icon" href="https://stackoverflow.com/users/5443023" target="_blank" rel="noopener" title="Stack Overflow">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M20.8863636,23.7090909 L20.8863636,17.3818182 L22.9863636,17.3818182 L22.9863636,25.8090909 L4.03181818,25.8090909 L4.03181818,17.3818182 L6.13181818,17.3818182 L6.13181818,23.7090909 L20.8863636,23.7090909 Z M8.45,16.7818182 L8.88636364,14.7090909 L19.1954545,16.8636364 L18.7590909,18.9363636 L8.45,16.7818182 Z M9.81363636,11.8727273 L10.6863636,9.93636364 L20.2318182,14.4090909 L19.3590909,16.3181818 L9.81363636,11.8727273 Z M12.4590909,7.18181818 L13.7954545,5.57272727 L21.8954545,12.3090909 L20.5590909,13.9181818 L12.4590909,7.18181818 Z M17.6954545,2.19090909 L23.9681818,10.6454545 L22.2772727,11.9 L16.0045455,3.44545455 L17.6954545,2.19090909 Z M8.23181818,21.5818182 L8.23181818,19.4818182 L18.7590909,19.4818182 L18.7590909,21.5818182 L8.23181818,21.5818182 Z"></path>
        </svg>
    </a>
    
    
    

    
</div>




	<div class="footer-mobile-links">
		<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="/js/main.min.a7205ef73b078c8daed6fe1b0826e8ba229ffabbb69d299d9446cf41f2c7d8aa.js" integrity="sha256-pyBe9zsHjI2u1v4bCCbouiKf+ru2nSmdlEbPQfLH2Ko="></script>
</footer>
    </body>
</html>